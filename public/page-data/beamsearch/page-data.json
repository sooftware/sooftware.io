{
    "componentChunkName": "component---src-templates-post-tsx",
    "path": "/beamsearch/",
    "result": {"data":{"logo":null,"markdownRemark":{"html":"<h1>Beam Search (빔서치)</h1>\n<p>본 포스팅은 “빔서치”에 대한 본질적인 개념보다는 Encoder-Decoder 모델 (Seq2seq) 을 기반으로 한 모델에서 빔서치가 어떻게 적용되는지에 중점을 두었습니다.</p>\n<p>본 포스팅을 이해하기 위해서는 다음 글에 대한 이해가 선행되는 것이 좋습니다.</p>\n<ul>\n<li><a href=\"sooftware.io/seq2seq\">Seq2seq</a></li>\n</ul>\n<h2>Greedy Search</h2>\n<p>기본적인 Sequence to sequence (이하 Seq2seq) 모델에서의 디코딩 과정은 보통 Greedy Decoding 방식을 따른다.</p>\n<img src=\"https://postfiles.pstatic.net/MjAyMDAyMTRfMjg0/MDAxNTgxNjY1NzgwNzg4.TG6-jfv_Tv793_EYtqJHevn9DZZg8embzYlBRTIObKsg.33Qhj4V3zkzfExxAPhyQIJJ6ClCW2TqJvYzlYJXf0twg.PNG.sooftware/image.png?type=w773\" width=\"500\">\n<p>Greedy Decoding이란 단순하게 해당 시점에서 가장 확률이 높은 후보를 선택하는 것이다. 시간복잡도 면에서는 훌륭한 방법이지만, 최종 정확도 관점에서는 좋지 못한 방법이다.</p>\n<p>특정 시점 t에서의 확률 분포 상에서 상위 1등과 2등의 확률 차이가 작든 크든, Greedy Decoding 방식은 무조건 가장 큰 놈에게만 관심이 있을 뿐이다.<br>\n(1등과 2등의 차이가 정말 미묘하다면,  2등이 정답일 경우도 고려해주어야 할 것이다)</p>\n<p>이러한 예측에서 한 번이라도 틀린 예측이 나오게 된다면, 이전 예측이 중요한 디코딩 방식에서는 치명적인 문제가 된다.</p>\n<h2>Beam Search</h2>\n<p>Greedy Decoding의 이러한 단점을 “어느 정도” 극복하기 위해 나온 방법이다.</p>\n<p>가장 좋은 방법은 나올 수 있는 모든 경우의 수를 고려한 뒤 누적 확률이 가장 높은 한 경우를 선택하는 것이겠지만, 이는 시간복잡도 면에서 사실상 불가능한 방법이다.</p>\n<p>빔서치는 이러한 Greedy Decoding과 모든 경우의 수를 고려하는 방법의 타협점이다. 해당 시점에서 유망한 빔의 개수만큼 (이하 K) 골라서 진행하는 방식이다. 그럼 이제 어떤 방식으로 진행이 되는지를 살펴보자. ( K = 3 )</p>\n<h3>Start</h3>\n<img src=\"https://postfiles.pstatic.net/MjAyMDAyMTRfNjMg/MDAxNTgxNjY2NzE2NTQx.yShOrDp-SSfiUO2CKJd9h1ksciZmVNjd4etx9AIfgdog.jjFWDg8KWGYt722EM2WWJbcUQ3BzOlnXcAKQZWMFoIIg.PNG.sooftware/image.png?type=w773\" width=\"400\">\n<p>START 토큰이 입력된다.</p>\n<h3>Step 1</h3>\n<img src=\"https://postfiles.pstatic.net/MjAyMDAyMTRfMTY2/MDAxNTgxNjY3MTkzMjE5.rFhdDCVM3oDGNr_6FavFfwbLoJV74kG75VU7LGXQpZgg.pNFDGnIBASpX3CHDeVxYCh1aXZaTIU9SbE2SsDDSL9Eg.PNG.sooftware/image.png?type=w773\" width=\"400\">\n<p>START 입력을 바탕으로 나온 예측 값의 확률 분포 중 가장 높은 확률 K개를 고른다.</p>\n<p>(이제부터 이 K개의 갈래는 각각 하나의 빔이 됩니다)</p>\n<h3>Step 2</h3>\n<img src=\"https://postfiles.pstatic.net/MjAyMDAyMTRfNDkg/MDAxNTgxNjY3NDQ1ODM4.h8B2A0x3gJDVE21S9_z-pjPlcpZEJHZ66iv2Tul8E6Mg.UUmVyhQryqimcNVUlf2RMSrBuOWsyEa4JNjejZKQglwg.PNG.sooftware/image.png?type=w773\" width=\"400\">\n<p>K개의 빔에서 각각 다음 예측 값의 확률 분포 중 가장 높은 K개를 고른다.</p>\n<p>( 이를 자식 노드라고 하겠습니다 )</p>\n<h3>Step 3</h3>\n<img src=\"https://postfiles.pstatic.net/MjAyMDAyMTRfMTIg/MDAxNTgxNjY3ODgzNDM5.8AaXI7wrBVjkELlmUiJyN6GV9AUi9Ib_Ss_dZUlxI9Ug.ls3xjlWUo-jtuCBrVDIvE2S55m0HyWNU32SnLHflwokg.PNG.sooftware/image.png?type=w773\" width=\"400\">  \n<p>총 K<sup>2</sup>개의 자식 노드 중 누적 확률 순으로 상위 K개를 뽑는다.</p>\n<ul>\n<li>※ 주의 사항 ※</li>\n</ul>\n<p>빔서치에서 고려하는 모든 확률은 누적 확률입니다. 어떠한 자식 노드들이 서로 같은 확률을 가지더라도, 어떤 빔에서 뻗어나왔냐에 따라 누적 확률은 달라지게 됩니다.</p>\n<h3>Step 4</h3>\n<img src=\"https://postfiles.pstatic.net/MjAyMDAyMTRfNjcg/MDAxNTgxNjY4NTY5ODEz.1WZ8surW0FlC3cn5acjjHqAzGMtZp7v-OewyN0L0S-4g.FRdqpj6fGiQdOohqBef8GeRcytLejQZzooCf8UkDRrgg.PNG.sooftware/image.png?type=w773\" width=\"400\">\n<p>뽑힌 상위 K개의 자식노드를 새로운 빔으로, 다시 상위 K개의 자식 노드를 만든다.</p>\n<h3>Step 5</h3>\n<p>EOS를 만난 빔이 K개가 될 때까지 Step3 - Step4를 반복한다.</p>\n<p>이상이 빔서치의 전반적인 과정이다.</p>\n<h2>EOS(End Of Sentence) Token</h2>\n<p>위에서 살펴본 빔서치에서 각각의 빔은 EOS를 만날 때까지 Step1 ~ Step5의 과정을 진행한다.<br>\n그럼 어떠한 빔이 EOS를 만났을 때는 어떤 과정이 일어나는지를 살펴보자.</p>\n<img src=\"https://postfiles.pstatic.net/MjAyMDAyMTRfMTMg/MDAxNTgxNjY5MDQ2ODcy.L2IgKv5RfUFwXcj2f6333vDAZ2K9UP7N6t5Nti8sqGIg.8nGwd0S3QV75lYqKIv3HGwvMx5aHIM7XplwouHYGCsog.PNG.sooftware/image.png?type=w773\" width=\"400\">\n<p>위의 그림처럼 어떤 빔이 EOS (or END) 를 만나게 되면 해당 빔은 최종 선택 후보에 오르게 된다.</p>\n<img src=\"https://postfiles.pstatic.net/MjAyMDAyMTRfMzgg/MDAxNTgxNjY5MTYxMzgw.fWQKLCZcJgmWdhsSm7Jgrr7jGv1zXejbQHyaEm1tq6Ag.l1j4aRQXdtRAzYICeRLLipYwfqj1rn4KJLLbo8QdhjEg.PNG.sooftware/image.png?type=w773\" width=\"300\">\n<p>그리고, 끝난 빔의 자리를 대신하여, 해당 시점에서 상위 K개에 밀려서 K+1위를 차지했던 빔이 활성화 되어서 이후 K개의 빔을 유지한다.</p>\n<p>( 어떤 시점에서 x개의 빔이 EOS를 만나서 종료된다면, 상위 K+1위 ~ K+x위의 빔이 활성화된다 )</p>\n<img src=\"https://postfiles.pstatic.net/MjAyMDAyMTRfMjI3/MDAxNTgxNjY5Nzk1Nzc5.WcJRVuXVhGLArn1Z1pVC40t0sBg0dGNRrP9wTb1C2Isg.JVCS0pWZCZXk1G6and6Gnc8eO3X_dlCdCgzAehztsJ4g.PNG.sooftware/image.png?type=w773\" width=\"300\">\n<p>그렇게 EOS를 만난 빔이 K개가 될 때까지 진행하고, EOS를 만난 빔이 K개가 된다면, 총 K개의 후보 중에서 가장 높은 누적 확률을 가진 빔을 최종적으로 선택한다.</p>\n<h2>Length Penalty</h2>\n<p>마지막으로 누적 확률 계산시에 필요한 Length Penalty를 살펴보자. 확률의 범위는 0.0 ~ 1.0이다. 이는 누적하여 곱할수록, 크기가 점점 작아진다는 것을 의미한다.</p>\n<p>그렇다면, 당연히 빔의 길이가 길어질수록 누적 확률의 값이 작아지는 것은 당연할 것이다. 이러한 길이에 따른 불공평을 해소하기 위해 Length Penalty라는 개념이 나오게 된다.</p>\n<img src=\"https://wenchenli.github.io/assets/img/GNMT_lp_cp.png\" width=\"300\">\n<p>간단한 공식으로 길이가 길어짐으로 인해 발생하는 불공평성을 해결해주는 것이다. 보통 알파는 1.2 정도의 값을 사용한다고 한다. 위의 공식에서는 바로 5로 들어가 있지만, minimum length로 이것 역시 설정 가능한 파라미터이다.</p>\n<p>파이썬 코드로는 다음과 같이 간단하게 구현할 수 있다.</p>\n<img src=\"https://postfiles.pstatic.net/MjAyMDAzMTBfNDcg/MDAxNTgzNzY3MTI0MTM2.KymToJM4wsR0_f0dGEr5ywplz7qrD9oKGiu4fpb_4lsg.OFZSBKDyEsT-RbF3ZuBiyqYVsc1S92UToSv_ljEocR0g.PNG.sooftware/image.png?type=w773\" width=\"300\">\n<p>위의 코드로 나온 결과값으로 현재 빔의 누적 확률을 나눠주면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">new_prob = prob ÷ length_penalty </code></pre></div>\n<h2>Beam Search의 성능</h2>\n<p>Beam Search와 Greedy Decoding의 차이점은 단지 Greedy Decoding은 K=1인 Beam Search라는 것이다.</p>\n<p>그러므로 당연히 더 많은 경우의 수를 고려해주므로, 예측 결과 역시 좋아지는 경우가 많다.</p>\n<img src=\"https://postfiles.pstatic.net/MjAyMDAyMTRfMjM3/MDAxNTgxNjcwNDAyOTMz.HYN1116EYI3BnarJyufB2u57VIE-xbvpLylzblO5Ctkg.1ka-o6UfTNXrID5p6NvdXgJbuUDE4t1VOdJ8Pl894oUg.PNG.sooftware/image.png?type=w773\" width=\"400\">\n<p>위는 빔 크기가 커짐에 따라 표현이 더욱 풍부해진 것을 확인할 수 있는 표이다. 실제로 빔서치를 적용하면 기계 번역에서 BLEU 성능이 2 가량 올라간다고 한다.</p>\n<p>기계번역 뿐만 아니라, 본인이 음성 인식 대회에 참여했을 당시에 상위권 팀들 모두 입 모아서 빔서치를 적용했을 때 성능이 가장 많이 올랐다고 할 정도로 빔서치의 적용 여부는 NLP 모델의 성능에 크게 기여한다고 볼 수 있다.</p>\n<p>다만 빔서치의 단점이라면, 기존 Greedy Decoding에 비해 코드로 구현하여 적용하기가 어렵다는 점이다.</p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"Beam Search (빔서치)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"본 포스팅은 “빔서치”에 대한 본질적인 개념보다는 Encoder-Decoder 모델 (Seq2seq) 을 기반으로 한 모델에서 빔서치가 어떻게 적용되는지에 중점을 두었습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"본 포스팅을 이해하기 위해서는 다음 글에 대한 이해가 선행되는 것이 좋습니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"sooftware.io/seq2seq"},"children":[{"type":"text","value":"Seq2seq"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Greedy Search"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"기본적인 Sequence to sequence (이하 Seq2seq) 모델에서의 디코딩 과정은 보통 Greedy Decoding 방식을 따른다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"https://postfiles.pstatic.net/MjAyMDAyMTRfMjg0/MDAxNTgxNjY1NzgwNzg4.TG6-jfv_Tv793_EYtqJHevn9DZZg8embzYlBRTIObKsg.33Qhj4V3zkzfExxAPhyQIJJ6ClCW2TqJvYzlYJXf0twg.PNG.sooftware/image.png?type=w773","width":500},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Greedy Decoding이란 단순하게 해당 시점에서 가장 확률이 높은 후보를 선택하는 것이다. 시간복잡도 면에서는 훌륭한 방법이지만, 최종 정확도 관점에서는 좋지 못한 방법이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"특정 시점 t에서의 확률 분포 상에서 상위 1등과 2등의 확률 차이가 작든 크든, Greedy Decoding 방식은 무조건 가장 큰 놈에게만 관심이 있을 뿐이다."},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n(1등과 2등의 차이가 정말 미묘하다면,  2등이 정답일 경우도 고려해주어야 할 것이다)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이러한 예측에서 한 번이라도 틀린 예측이 나오게 된다면, 이전 예측이 중요한 디코딩 방식에서는 치명적인 문제가 된다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Beam Search"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Greedy Decoding의 이러한 단점을 “어느 정도” 극복하기 위해 나온 방법이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"가장 좋은 방법은 나올 수 있는 모든 경우의 수를 고려한 뒤 누적 확률이 가장 높은 한 경우를 선택하는 것이겠지만, 이는 시간복잡도 면에서 사실상 불가능한 방법이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"빔서치는 이러한 Greedy Decoding과 모든 경우의 수를 고려하는 방법의 타협점이다. 해당 시점에서 유망한 빔의 개수만큼 (이하 K) 골라서 진행하는 방식이다. 그럼 이제 어떤 방식으로 진행이 되는지를 살펴보자. ( K = 3 )"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Start"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"https://postfiles.pstatic.net/MjAyMDAyMTRfNjMg/MDAxNTgxNjY2NzE2NTQx.yShOrDp-SSfiUO2CKJd9h1ksciZmVNjd4etx9AIfgdog.jjFWDg8KWGYt722EM2WWJbcUQ3BzOlnXcAKQZWMFoIIg.PNG.sooftware/image.png?type=w773","width":400},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"START 토큰이 입력된다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Step 1"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"https://postfiles.pstatic.net/MjAyMDAyMTRfMTY2/MDAxNTgxNjY3MTkzMjE5.rFhdDCVM3oDGNr_6FavFfwbLoJV74kG75VU7LGXQpZgg.pNFDGnIBASpX3CHDeVxYCh1aXZaTIU9SbE2SsDDSL9Eg.PNG.sooftware/image.png?type=w773","width":400},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"START 입력을 바탕으로 나온 예측 값의 확률 분포 중 가장 높은 확률 K개를 고른다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"(이제부터 이 K개의 갈래는 각각 하나의 빔이 됩니다)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Step 2"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"https://postfiles.pstatic.net/MjAyMDAyMTRfNDkg/MDAxNTgxNjY3NDQ1ODM4.h8B2A0x3gJDVE21S9_z-pjPlcpZEJHZ66iv2Tul8E6Mg.UUmVyhQryqimcNVUlf2RMSrBuOWsyEa4JNjejZKQglwg.PNG.sooftware/image.png?type=w773","width":400},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"K개의 빔에서 각각 다음 예측 값의 확률 분포 중 가장 높은 K개를 고른다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"( 이를 자식 노드라고 하겠습니다 )"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Step 3"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"https://postfiles.pstatic.net/MjAyMDAyMTRfMTIg/MDAxNTgxNjY3ODgzNDM5.8AaXI7wrBVjkELlmUiJyN6GV9AUi9Ib_Ss_dZUlxI9Ug.ls3xjlWUo-jtuCBrVDIvE2S55m0HyWNU32SnLHflwokg.PNG.sooftware/image.png?type=w773","width":400},"children":[]},{"type":"text","value":"  \n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"총 K"},{"type":"element","tagName":"sup","properties":{},"children":[{"type":"text","value":"2"}]},{"type":"text","value":"개의 자식 노드 중 누적 확률 순으로 상위 K개를 뽑는다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"※ 주의 사항 ※"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"빔서치에서 고려하는 모든 확률은 누적 확률입니다. 어떠한 자식 노드들이 서로 같은 확률을 가지더라도, 어떤 빔에서 뻗어나왔냐에 따라 누적 확률은 달라지게 됩니다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Step 4"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"https://postfiles.pstatic.net/MjAyMDAyMTRfNjcg/MDAxNTgxNjY4NTY5ODEz.1WZ8surW0FlC3cn5acjjHqAzGMtZp7v-OewyN0L0S-4g.FRdqpj6fGiQdOohqBef8GeRcytLejQZzooCf8UkDRrgg.PNG.sooftware/image.png?type=w773","width":400},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"뽑힌 상위 K개의 자식노드를 새로운 빔으로, 다시 상위 K개의 자식 노드를 만든다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Step 5"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"EOS를 만난 빔이 K개가 될 때까지 Step3 - Step4를 반복한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"이상이 빔서치의 전반적인 과정이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"EOS(End Of Sentence) Token"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위에서 살펴본 빔서치에서 각각의 빔은 EOS를 만날 때까지 Step1 ~ Step5의 과정을 진행한다."},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n그럼 어떠한 빔이 EOS를 만났을 때는 어떤 과정이 일어나는지를 살펴보자."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"https://postfiles.pstatic.net/MjAyMDAyMTRfMTMg/MDAxNTgxNjY5MDQ2ODcy.L2IgKv5RfUFwXcj2f6333vDAZ2K9UP7N6t5Nti8sqGIg.8nGwd0S3QV75lYqKIv3HGwvMx5aHIM7XplwouHYGCsog.PNG.sooftware/image.png?type=w773","width":400},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위의 그림처럼 어떤 빔이 EOS (or END) 를 만나게 되면 해당 빔은 최종 선택 후보에 오르게 된다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"https://postfiles.pstatic.net/MjAyMDAyMTRfMzgg/MDAxNTgxNjY5MTYxMzgw.fWQKLCZcJgmWdhsSm7Jgrr7jGv1zXejbQHyaEm1tq6Ag.l1j4aRQXdtRAzYICeRLLipYwfqj1rn4KJLLbo8QdhjEg.PNG.sooftware/image.png?type=w773","width":300},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그리고, 끝난 빔의 자리를 대신하여, 해당 시점에서 상위 K개에 밀려서 K+1위를 차지했던 빔이 활성화 되어서 이후 K개의 빔을 유지한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"( 어떤 시점에서 x개의 빔이 EOS를 만나서 종료된다면, 상위 K+1위 ~ K+x위의 빔이 활성화된다 )"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"https://postfiles.pstatic.net/MjAyMDAyMTRfMjI3/MDAxNTgxNjY5Nzk1Nzc5.WcJRVuXVhGLArn1Z1pVC40t0sBg0dGNRrP9wTb1C2Isg.JVCS0pWZCZXk1G6and6Gnc8eO3X_dlCdCgzAehztsJ4g.PNG.sooftware/image.png?type=w773","width":300},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그렇게 EOS를 만난 빔이 K개가 될 때까지 진행하고, EOS를 만난 빔이 K개가 된다면, 총 K개의 후보 중에서 가장 높은 누적 확률을 가진 빔을 최종적으로 선택한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Length Penalty"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"마지막으로 누적 확률 계산시에 필요한 Length Penalty를 살펴보자. 확률의 범위는 0.0 ~ 1.0이다. 이는 누적하여 곱할수록, 크기가 점점 작아진다는 것을 의미한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그렇다면, 당연히 빔의 길이가 길어질수록 누적 확률의 값이 작아지는 것은 당연할 것이다. 이러한 길이에 따른 불공평을 해소하기 위해 Length Penalty라는 개념이 나오게 된다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"https://wenchenli.github.io/assets/img/GNMT_lp_cp.png","width":300},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"간단한 공식으로 길이가 길어짐으로 인해 발생하는 불공평성을 해결해주는 것이다. 보통 알파는 1.2 정도의 값을 사용한다고 한다. 위의 공식에서는 바로 5로 들어가 있지만, minimum length로 이것 역시 설정 가능한 파라미터이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"파이썬 코드로는 다음과 같이 간단하게 구현할 수 있다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"https://postfiles.pstatic.net/MjAyMDAzMTBfNDcg/MDAxNTgzNzY3MTI0MTM2.KymToJM4wsR0_f0dGEr5ywplz7qrD9oKGiu4fpb_4lsg.OFZSBKDyEsT-RbF3ZuBiyqYVsc1S92UToSv_ljEocR0g.PNG.sooftware/image.png?type=w773","width":300},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위의 코드로 나온 결과값으로 현재 빔의 누적 확률을 나눠주면 된다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"new_prob = prob ÷ length_penalty "}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Beam Search의 성능"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Beam Search와 Greedy Decoding의 차이점은 단지 Greedy Decoding은 K=1인 Beam Search라는 것이다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"그러므로 당연히 더 많은 경우의 수를 고려해주므로, 예측 결과 역시 좋아지는 경우가 많다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"https://postfiles.pstatic.net/MjAyMDAyMTRfMjM3/MDAxNTgxNjcwNDAyOTMz.HYN1116EYI3BnarJyufB2u57VIE-xbvpLylzblO5Ctkg.1ka-o6UfTNXrID5p6NvdXgJbuUDE4t1VOdJ8Pl894oUg.PNG.sooftware/image.png?type=w773","width":400},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"위는 빔 크기가 커짐에 따라 표현이 더욱 풍부해진 것을 확인할 수 있는 표이다. 실제로 빔서치를 적용하면 기계 번역에서 BLEU 성능이 2 가량 올라간다고 한다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"기계번역 뿐만 아니라, 본인이 음성 인식 대회에 참여했을 당시에 상위권 팀들 모두 입 모아서 빔서치를 적용했을 때 성능이 가장 많이 올랐다고 할 정도로 빔서치의 적용 여부는 NLP 모델의 성능에 크게 기여한다고 볼 수 있다."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"다만 빔서치의 단점이라면, 기존 Greedy Decoding에 비해 코드로 구현하여 적용하기가 어렵다는 점이다."}]}],"data":{"quirksMode":false}},"excerpt":"Beam Search (빔서치) 본 포스팅은 “빔서치”에 대한 본질적인 개념보다는 Encoder-Decoder 모델 (Seq2seq…","fields":{"readingTime":{"text":"9 min read"}},"frontmatter":{"title":"Beam Search (빔서치)","userDate":"14 February 2020","date":"2020-02-14T10:00:00.000Z","tags":["nlp"],"excerpt":null,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/2ff5ceb2a289c296c3f360461508704b/90853/beamsearch.png","srcSet":"/static/2ff5ceb2a289c296c3f360461508704b/d0f30/beamsearch.png 750w,\n/static/2ff5ceb2a289c296c3f360461508704b/90853/beamsearch.png 773w","sizes":"100vw"},"sources":[{"srcSet":"/static/2ff5ceb2a289c296c3f360461508704b/df98f/beamsearch.webp 750w,\n/static/2ff5ceb2a289c296c3f360461508704b/5b2f4/beamsearch.webp 773w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.8214747736093144}}},"author":[{"id":"Soohwan Kim","bio":"Co-founder and AI engineer of TUNiB.","avatar":{"children":[{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#182828","images":{"fallback":{"src":"/static/7ffe238930a689e103d70f234bb00199/a8b52/ghost.png","srcSet":"/static/7ffe238930a689e103d70f234bb00199/f31ef/ghost.png 40w,\n/static/7ffe238930a689e103d70f234bb00199/1f8a1/ghost.png 80w,\n/static/7ffe238930a689e103d70f234bb00199/a8b52/ghost.png 120w","sizes":"100vw"},"sources":[{"srcSet":"/static/7ffe238930a689e103d70f234bb00199/e73fe/ghost.webp 40w,\n/static/7ffe238930a689e103d70f234bb00199/61ca6/ghost.webp 80w,\n/static/7ffe238930a689e103d70f234bb00199/507b0/ghost.webp 120w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1}}]}}]}},"relatedPosts":{"totalCount":11,"edges":[{"node":{"id":"f8857a8d-9121-5e23-91bc-3fbe4f090418","excerpt":"Textless NLP: Generating expressive speech from raw audio paper / code / pre-train model / blog Name: Generative Spoken Language Model (GSLM…","frontmatter":{"title":"Textless NLP","date":"2021-09-19T10:00:00.000Z"},"fields":{"readingTime":{"text":"4 min read"},"slug":"/Textledd NLP: Generating expressive speech from raw audio/"}}},{"node":{"id":"3b2d6ea5-69c9-5459-815d-b59e3dbb34f8","excerpt":"Tokenization 문장에서 의미있는 단위로 나누는 작업을 라고 한다. 문자 단위 토큰화 문자 단위로 토큰화를 하는 것이다. 한글 음절 수는 모두 11,172개이므로 알파벳, 숫자, 기호 등을 고려한다고 해도 단어 사전의 크기는 기껏해야 1…","frontmatter":{"title":"Tokenizer","date":"2021-09-13T23:46:37.121Z"},"fields":{"readingTime":{"text":"10 min read"},"slug":"/tokenizer/"}}},{"node":{"id":"476f2558-a27e-5d36-bc5e-d8f8a5ca05e0","excerpt":"정규 표현식 정규표현식(regular expression)은 일종의 문자를 표현하는 공식으로, 특정 규칙이 있는 문자열 집합을 추출할 때 자주 사용되는 기법입니다. 주로 Prograaming Language나 Text Editor…","frontmatter":{"title":"정규표현식 (regex)","date":"2021-09-08T10:00:00.000Z"},"fields":{"readingTime":{"text":"30 min read"},"slug":"/regex/"}}},{"node":{"id":"eaa0dc8a-25ba-5f4e-9a44-0022cc38776d","excerpt":"최근 NLP 토크나이저를 만드는데 가장 많이 사용되는  라이브러와 실제 사용이 가장 많이 되는  라이브러리로의 변환에 대한 코드를 담고 있습니다. 해당 내용은  버젼에서 수행되었습니다. Train 아래 코드는 wordpiece, char-bpe…","frontmatter":{"title":"Hugging Face Tokenizers","date":"2021-08-11T15:11:55.000Z"},"fields":{"readingTime":{"text":"4 min read"},"slug":"/tokenizers/"}}},{"node":{"id":"261863c4-58d3-5883-b410-c0a7cc3d8319","excerpt":"GPT Understands, Too Xiao Liu et al. Tsinghua University etc. arXiv pre-print Abstract GPT를 파인튜닝하는 방법은 Narural Language Understanding (NLU…","frontmatter":{"title":"P-Tuning Paper Review","date":"2021-05-13T10:00:00.000Z"},"fields":{"readingTime":{"text":"4 min read"},"slug":"/p_tuning/"}}}]}},"pageContext":{"slug":"/beamsearch/","prev":{"excerpt":"「STATE-OF-THE-ART SPEECH RECOGNITION WITH SEQUENCE-TO-SEQUENCE MODEL」 Review title https://arxiv.org/abs/1712.0176…","frontmatter":{"title":"STATE-OF-THE-ART SPEECH RECOGNITION WITH SEQUENCE-TO-SEQUENCE MODEL Paper Review","tags":["speech","paper"],"date":"2020-02-03T10:00:00.000Z","draft":false,"excerpt":null,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaklEQVQ4y51TaUvDQBDN//8fKn6xLfip4PGlRaigItL0yGV6YY1Nu1eyOZ7ZrS1p6IEddpnJm5fHzO6sgZLleb71m1hZmqbgjO/NVc2oAuUfpJSIogjBTwDf93fyh0SNQ2KEEkgm0WVDXAYNXAe3aNHngqTWGYKT6QThPMRr8IGrrwYuxjU8sZfzBfW5CQ5OOCSRmHlTpCI9eY7GPlCT/yoRnoB748CpWSBvRGN6/bfCbaVxgpTGGL73YJsDMMaOVnnwltfcHK4r0GyGqNd9dDqL0y2Xx2B3rwVHfoTH+wUe7r5hdkWBZTpX7WYTG9XZyrKstNekOKYIw7mOFa55Jf6O4LGp35iUCShlJ3lKy+CMotVuwx+NMCtmr9frwbIt9Ad9eJ8eXM+D4ziYjEdwXBeWNSy8o1+Oim3bhmmaiOJ4U2GGIAjAOUeSSCyXSyxXKxBC9I0KIbRXT1DFlFKwgqswtUnxrTDVurJffDf0mCFVnMAAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/ccbbeff79541c85288ad06b096472221/8e70e/sota_speech.png","srcSet":"/static/ccbbeff79541c85288ad06b096472221/8e70e/sota_speech.png 546w","sizes":"100vw"},"sources":[{"srcSet":"/static/ccbbeff79541c85288ad06b096472221/dc201/sota_speech.webp 546w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6465201465201466}}},"author":[{"id":"Soohwan Kim","bio":"Co-founder and AI engineer of TUNiB.","avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCUlEQVQ4y2MQVdQiGzEMJ80iCppwBOcSpRlZHZop+DSLKWnzS6v0Tpl5/da9E2cuXL1xZ/6SlXxSyvOXrlq8cp2ArBpBzaqNnX1HT57Zvmf/4ROnJk6fwyutMnHG3GlzFgri1wxBAjKqQPthSBXoYIgIUc7umTT96vVbJ06fO3X2AhABGZev3Zgxb5GwvAYhzTJAZ/cfPXF2595Duw8cASIg4/Dx072TZxLQjOFsVTCCeoEoZ3dPnH7l2q1zF6+6BYSbO3mdPnfp8tWb0+cuEiLsbGnV5q4Jx8+cO3TspLNviKmD+/4jx4+dPtc/bRZRzhaSUxeUUwMioGphBU0IW1BOfZjnKnpoBgBuRuAIvQwT7gAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/7ffe238930a689e103d70f234bb00199/d6138/ghost.png","srcSet":"/static/7ffe238930a689e103d70f234bb00199/d6138/ghost.png 400w","sizes":"100vw"},"sources":[{"srcSet":"/static/7ffe238930a689e103d70f234bb00199/416c3/ghost.webp 400w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1}}}}]},"fields":{"readingTime":{"text":"12 min read"},"layout":"","slug":"/sota_sr_speech/"}},"next":{"excerpt":"ClovaCall: Korean Goal-Oriented Dialog Speech Corpus for Automatic Speech Recognition of Contact Centers image 논문링크 2020-04-2…","frontmatter":{"title":"ClovaCall Paper Review","tags":["speech","paper"],"date":"2020-03-13T10:00:00.000Z","draft":false,"excerpt":null,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA6klEQVQY011P2Y6DMAzk/38PWgLhSiEpRxKgWl5QYdYO7T6sJWsce8aeRMdxQKkGRVlAPR4oCgkhBOq6RlmWkDLH7X5DlgnkUqKqK+R5Tu8MqmkQxzH8PIPjPE9EXCilSChpaRnIvDwjvIQizNI0pQMVmqaGoB5r+GiSJPjZNnwj6roOk50w0xXnHJz38JQbkaZphHUWy7JQ34X5TDW/rbVBw9j3PfphwL7viIwxJJzAyAPzfKJtW4zjSD0d+t/UHxxIrLUO/Itngm59va4vcxzv9991dsLulnXFSjlSzW787C8kt+yM83/8Alz0dI6i3dakAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/d7bd082afa8ae681e2420238dc3cd6d0/c2b97/clovacall.png","srcSet":"/static/d7bd082afa8ae681e2420238dc3cd6d0/51d72/clovacall.png 750w,\n/static/d7bd082afa8ae681e2420238dc3cd6d0/b9600/clovacall.png 1080w,\n/static/d7bd082afa8ae681e2420238dc3cd6d0/c2b97/clovacall.png 1322w","sizes":"100vw"},"sources":[{"srcSet":"/static/d7bd082afa8ae681e2420238dc3cd6d0/1f497/clovacall.webp 750w,\n/static/d7bd082afa8ae681e2420238dc3cd6d0/8f986/clovacall.webp 1080w,\n/static/d7bd082afa8ae681e2420238dc3cd6d0/ffe85/clovacall.webp 1322w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.23600605143721634}}},"author":[{"id":"Soohwan Kim","bio":"Co-founder and AI engineer of TUNiB.","avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCUlEQVQ4y2MQVdQiGzEMJ80iCppwBOcSpRlZHZop+DSLKWnzS6v0Tpl5/da9E2cuXL1xZ/6SlXxSyvOXrlq8cp2ArBpBzaqNnX1HT57Zvmf/4ROnJk6fwyutMnHG3GlzFgri1wxBAjKqQPthSBXoYIgIUc7umTT96vVbJ06fO3X2AhABGZev3Zgxb5GwvAYhzTJAZ/cfPXF2595Duw8cASIg4/Dx072TZxLQjOFsVTCCeoEoZ3dPnH7l2q1zF6+6BYSbO3mdPnfp8tWb0+cuEiLsbGnV5q4Jx8+cO3TspLNviKmD+/4jx4+dPtc/bRZRzhaSUxeUUwMioGphBU0IW1BOfZjnKnpoBgBuRuAIvQwT7gAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/7ffe238930a689e103d70f234bb00199/d6138/ghost.png","srcSet":"/static/7ffe238930a689e103d70f234bb00199/d6138/ghost.png 400w","sizes":"100vw"},"sources":[{"srcSet":"/static/7ffe238930a689e103d70f234bb00199/416c3/ghost.webp 400w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":1}}}}]},"fields":{"readingTime":{"text":"12 min read"},"layout":"","slug":"/clovacall/"}},"primaryTag":"nlp"}},
    "staticQueryHashes": ["3170763342","3229353822"]}